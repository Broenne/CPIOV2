/*
 * FlipFlop.c
 *
 *  Created on: 24.01.2019
 *      Author: MB
 */

#include "FlipFlop.h"

static uint16_t StorageFlipFlopState = 0xFF;

/*
 *  Created on: 24.01.2019
 *      Author: MB
 *
 *      Die Funktion setzt den FlipFlop Zustand des Kanals, wenn es eine Änderung gab.
 *      Es wird eine Nachricht auf den CAN-BUS mit der Info gelegt.
 */
void SetFlipFlop(uint8_t channel){

	int mask = 1 << channel;
	StorageFlipFlopState |= mask;

	uint16_t data = StorageFlipFlopState;
	SendFlipFlopStateViaCan(data);
}

/*
 *  Created on: 24.01.2019
 *      Author: MB
 *
 *      Es wird der Kanal, oder die Kanäle zurück gesetzt
 */
void ResetFlipFlop(uint8_t* resetChannelsBitmask){

	uint16_t resetMask = 0;
	resetMask |= (resetChannelsBitmask[0]);
	 resetMask |= (resetChannelsBitmask[1] << 8);



	// Bit 0-1
	// Bitmaske, welcher KAnäle resetet werden
	StorageFlipFlopState = 0x00;


	// zur Bestätigung wieder wegsenden
	uint16_t data = StorageFlipFlopState;
	SendFlipFlopStateViaCan(data);
}

